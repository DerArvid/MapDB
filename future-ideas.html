<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Dec 25, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20121225" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MapDB - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<script src="js/jquery.min.js"></script>
                      
        
<script src="js/donate.js"></script>
                      
        
<script src="js/excanvas.js"></script>
                      
        
<script src="js/js-class.js"></script>
                      
        
<script src="js/bluff.js"></script>
          
            </head>
        <body class="topBarEnabled">
          
    
    
            
    
        
    <a href="http://github.com/JanKotek/MapDB">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                                                                <a class="brand" href="index.html"  title="MapDB">

                                
                                                                                                                    <img src="images/logo.png" alt="MapDB" />
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">MapDB <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Introduction">Introduction</a>
</li>
                  
                      <li>      <a href="features.html"  title="Features">Features</a>
</li>
                  
                      <li>      <a href="faq.html"  title="Frequently Asked Questions">Frequently Asked Questions</a>
</li>
                  
                      <li>      <a href="future-ideas.html"  title="Future Ideas">Future Ideas</a>
</li>
                  
                      <li>      <a href="credits.html"  title="Credits">Credits</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="index.html"  title="About">About</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="dependency-info.html"  title="Dependency Information">Dependency Information</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="integration.html"  title="Continuous Integration">Continuous Integration</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="plugin-management.html"  title="Plugin Management">Plugin Management</a>
</li>
                                  <li>      <a href="distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                                  <li>      <a href="mail-lists.html"  title="Mailing Lists">Mailing Lists</a>
</li>
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD Report">PMD Report</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD Report">CPD Report</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs Report">FindBugs Report</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
                      <form id="search-form" action="http://www.google.com/search" method="get"  class="navbar-search pull-right" >
    
  <input value="www.mapdb.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
                                                              
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>MapDB</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-12-25</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.9-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <h1>Future Ideas</h1>

<h3>Increase maximal record size over 64KB</h3>

<p>Serialized record size can not be currently bigger than 64KB. It is because record size is marked with 2-byte-long number.
MapDB should support record size up to 256MB. Plan is to chain small records into linked list.</p>

<h3>Engine wrappers to support Network Sockets</h3>

<p>MapDB does not support client-server communication directly, but user may implement it themselfs.
So there should be two engine wrappers <code>SocketServerEngine</code> and <code>SocketClientEngine</code> to allow using MapDB remotely over network socket. It should rely on already established connection (users responsibility).</p>

<h3>Unsafe Memory Store</h3>

<p>MapDB relies on mapped ByteBuffers and those use <code>sun.misc.Unsafe</code> class internaly. Using <code>Unsafe</code> class directly may increase performance. But this means bypassing JVM protections and could crash JVM. We should also investigate hybrid approach (for example only index Volume is unsafe).
Apache Memory Direct project is using this.</p>

<h3>Unsafe class in deserialization</h3>

<p><code>sun.misc.Unsafe</code> methods allows directly manipulating class structure. It bypasses JVM protections and should be faster than reflection. Lightnight serializer is using it.</p>

<h3>Internal Fork/Join framework</h3>

<p>Scala Parallel Collections supports operations such as <code>map</code>, <code>reduce</code>, <code>filter</code>, <code>contains</code> executed in parallel. Fork/Join framework (used by Scala) needs to divide collection into parts to work efectively. So parallel operations
are usually performed on indexed array style collection, where splitting into parts is easy.
MapDB could use internal tree node structure to achive this split. My estimate is that internal Fork/Join framework would be 30% faster than similar parallel solution which would rely on iterators.</p>

<h3>Lirs Cache</h3>

<p>MapDB does not currently have MRU (Most Recently Used) or LIRS (Low Inter-
reference Recency Set) cache. Main problem is concurrent scalability of such cache.
There is <a href="http://code.google.com/p/concurrentlinkedhashmap/">project</a>
under development, we should integrate it into MapDB when it matures.</p>

<h3>Full Java Serialization compability</h3>

<p>MapDB serialization tryes to mimic standard Java Serialization (for example Serializable marker interface).
However there are still many cases we do not support, such as Externalizable and writeExternal/readExternal methods.
This may cause some code to be incompatible with MapDB.</p>

<h3>Optimize Transaction Log instructions</h3>

<p>Transaction log could be smaller (and transactions faster). We could reduce size by choosing right type of log replay
instructions. This applies mostly to LongStack updates (currently entire record is dumped even if only single slot changes).</p>

<h3>Raw Disk Partition support</h3>

<p><a href="http://stackoverflow.com/questions/2108313/how-to-access-specific-raw-data-on-disk-from-java">Pure Java is capable</a> of using raw disk partition on most operating system. Raw Disk Partition means bypassing filesystem and probably better performance. MapDB should be capable of using it directly. We should document it, present examples and make sure
it works faster. Storage should be also capable of spreading over multiple partitions for best performance.</p>

<h3>SSD Trim support</h3>

<p>We need to make sure that MapDB works well with SSD drives. It means that SSD needs to know about free space within storage file. This may be achieved by writing zeroes into unused space (just a guess). We could also use native library to issue trim instructions.</p>

<h3>Split storage file across multiple disks</h3>

<p>MapDB should be capable of using multiple disks. This means splitting storage file into smaller chunks (1GB) and spreading it into multiple directories.</p>

<h3>Single file storage</h3>

<p>MapDB currently uses two files (index, phys). There is also third file (trans log) to support transactions.
Index file needs to be in separate Volume to reduce fragmentation.
But storage could be stored in single file. For example virtual Index Volume could be created in first 1GB
of storage file. We could also create packed single file read-only storage.</p>

<h3>BTree delta serializers</h3>

<p>Delta compression can be applied to any ordered set, it means storing first entry and than only differences. Currently it is applied only on Long[]. However we should provide BTree key serializers for other data types (String)
as well.</p>

<h3>Storage Engine Write Overlay</h3>

<p>An mode where MapDB uses read-only primary storage and stores all modifications in secondary writable storage. This could be used when main (remote) db can not be modified, but we need to apply changes locally.</p>

<h3>Lock Free Storage</h3>

<p>Current storage implementation uses <code>ReentrantReadWriteLock</code>. Write operation needs exclusive lock and blocks other reads. To workaround this limitation most writes are performed asynchronously in background thread. This does not scale well on large number of CPU cores (8+). 
To improve concurrency we need Storage without global locks. Exclusive locks should only apply to directly modified area of file. </p>

<h3>Primitive Long BTree</h3>

<p>MapDB uses <code>LongMap</code> as fast cache. We should try to modify current BTree implementation to support primitive long keys. This should improve performance and decrease memory consumption.</p>

<h3>Serialization - class and field rename</h3>

<p>Serialized class structure information is stored on single place for all record. So renaming class or field for entire store requires very small modification. There should be utility to support basic refactoring on already created store.</p>

<h3>Map Entry Expiration Interval</h3>

<p>It should be possible to use MapDB as cache with expiration period for each Map Entry. Expired entryes should be removed from store by background thread. </p>

<h3>Master-Slave replication</h3>

<p>It should be possible to setup MapDB into simple cluster similar way as MySQL. There would be single write-able master and multiple read-only slaves. Changes made on master would be distributed to slaves. </p>

<h3>Concurrent transaction</h3>

<p>MapDB currently supports only single transaction. It should handle multiple concurreent transactions with record isolation, locking and all usuall stuff. There is solution which would require only minimal modificaiton and would have nearly zero impact on performance. </p>

<h3>Java Transaction API support</h3>

<p>With concurrrent transaction we should support JTA as well. It is widely used Java standard for various databases.</p>

<h3>Hash collision attack protection</h3>

<p>Most libraries (including <code>j.u.HashMap</code>) are vulnerable to <a href="http://arstechnica.com/business/2011/12/huge-portions-of-web-vulnerable-to-hashing-denial-of-service-attack/">hash collision attack</a>. MapDB could be indirectly exposed to internet, so it should be immune to this attack. Solution is to add randomly generated hash salt into each store, and rehash all caches and HTreeMaps</p>

<h3>GUI store explorer</h3>

<p>There should be an application which would allow to open and explore existing storage files. It should provide possibility to search modify serialized records.</p>

<h3>Administration GUI</h3>

<p>There should be an GUI application for monitoring running MapDB. It should provide runtime informations such as cache-miss stats, memory consumption and fragmentation. </p>

<h3>JMX support</h3>

<p>Java Management Extension is standard API to monitor and manage applications deployed in enterprise environment. MapDB should provide statistics via this interface. </p>

<h3>Cache miss statistics</h3>

<p>Cache miss statistics are esential for performance tunning. MapDB should be able to provide it</p>

<h3>Store statistics</h3>

<p>MapDB should provide basic store statistics (space usage, fragmentation,...)</p>

<h3>Load/Save DBMaker configuration</h3>

<p>It should be possible to load </p>

<h3>.NET port</h3>

<p>It should be possible to port MapDB into CLI virtual machine. JVM and CLI are similar (threading, IO API).</p>

<h3>XML DOM Parser with MapDB backend</h3>

<p>DOM parsers are probably most intuitive way to manipulate XML. However those do not work well on large files. We could implement DOM parser which would use MapDB to store parsed data. It could manipulate HUGE files without sweat. </p>

                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
              <div class="row span12">Copyright &copy;                   2012.
          All Rights Reserved.      
            
      </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
  </body>
</html>
